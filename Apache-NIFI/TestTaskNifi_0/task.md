Вы работаете в компании, которая производит и продаёт фигурки персонажей Гарри Поттера.
В файле sales.csv сгенерирована история продаж. Этот файл можно пополнять при помощи python скриптов, имитируя поступление свежих данных (генерация идёт целыми днями, по 1 или по нескольку дней за 1 запуск).
Кроме того, имеется сторонняя база данных https://hp-api.onrender.com/, которая предоставляет REST API интерфейс, и имитирует расширенный набор мастер данных, детально описывающий каждую SKU.

Неободимо реализовать ETL поток в среде Nifi, который позволит считывать факт продаж из sales.csv, группировать его до детализации sale_date - house - amount - last_verstamp, и запишет результаты в файл house_sales.csv. 
House - атрибут персонажа, характеризующий Факультет, к которому тот относится, и информация о котором есть только в API.

Реализация должна учитывать, что при поступлении свежих данных в sales.csv, поток при очередном запуске должен забирать только новую информацию, и дозаписывать её в house_sales.csv (допускается вариант с генерацией нового файла при каждом запуске, рядом с уже существующими, но заполнение нового файла должно происходить только теми данными, которых не было во всех предыдущих запусках). 
Кроме того, мастер данные по SKU могут меняться (как бы это не было нелепо в контексте тематики, но представим себе, что операторы, заполняющие мастер данные, могут ошибиться, и в какой-то момент поменять атрибут персонажа), а значит обращаться в REST API нужно при каждом запуске потока. 

Решение прошу предоставить в формате выгруженного шаблона Nifi (в xml), и отправить нам. В дальнейшем на встрече было бы здорово, если бы Вы так же продемонстрировали пошаговый запуск потока в Nifi, объянили его логику работы и показали, какие особенности Вы бы хотели отметить.
